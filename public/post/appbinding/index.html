<!doctype html><html lang=en><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-62096468-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#0071BD><title>Blog | ByteBuilders</title><link rel=apple-touch-icon sizes=57x57 href=/assets/images/products/bytebuilders/icons/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/assets/images/products/bytebuilders/icons/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/assets/images/products/bytebuilders/icons/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/assets/images/products/bytebuilders/icons/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/assets/images/products/bytebuilders/icons/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/assets/images/products/bytebuilders/icons/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/assets/images/products/bytebuilders/icons/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/assets/images/products/bytebuilders/icons/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/assets/images/products/bytebuilders/icons/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/assets/images/products/bytebuilders/icons/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/assets/images/products/bytebuilders/icons/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/assets/images/products/bytebuilders/icons/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/assets/images/products/bytebuilders/icons/favicon-16x16.png><link rel=manifest href=/assets/images/products/bytebuilders/icons/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/assets/images/products/bytebuilders/icons/ms-icon-144x144.png><link rel=stylesheet href=/assets/css/font-awesome.min.css><link rel=stylesheet href=/assets/css/bulma.min.css><link rel=stylesheet href=/assets/sass/main.min.css></head><body><header id=header><div class=header-top><div class=container><nav class="navbar customize-navbar" role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://byte.builders><img src=/assets/images/products/bytebuilders/bytebuilders.png></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-end><a href=https://marketplace.byte.builders class=navbar-item>Marketplace</a>
<a href=https://blog.byte.builders class=navbar-item>Blog</a>
<a href=https://appscode.com/about/ class=navbar-item>About Us</a>
<a href=https://appscode.com/contact/ class=navbar-item>Contact</a><div class=navbar-item><div class=buttons><a href=https://byte.builders/user/sign_up class="button is-light is-primary">Sign up</a>
<a href=https://byte.builders/user/login class="button is-primary">Sign in</a></div></div></div></div></nav></div></div></header><section class="blog-heading-area section-padding"><div class="container section"><div class=columns><div class="column has-text-centered"><div class=blog-heading><p class=meta-date><i class="fa fa-calendar" aria-hidden=true></i>1-Jan-2019</p><h1>The case for AppBinding</h1><p class=author><span>by </span><a href=/authors/tamal-saha>Tamal Saha</a></p></div><figure><img src=/post/appbinding/hero.jpg alt></a></figure></div></div></div></section><section class=blog-details-area><div class="container section"><div class=columns><div class="column is-2"><div class=sticky-social-menu><div class=social-link-vertical><ul><li><a title=Twitter href="http://twitter.com/share?url=https%3a%2f%2fblog.byte.builders%2fpost%2fappbinding%2f&text=The%20case%20for%20AppBinding" class=twitter aria-label="share on Twitter"><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a title=Linkedin href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.byte.builders%2fpost%2fappbinding%2f&title=The%20case%20for%20AppBinding&summary=Kubernetes%20has%20become%20the%20de-facto%20orchestrator%20for%20the%20cloud%20native%20world.%20Kubernetes%20upholds%20the%20philosophy%20that%20the%20core%20should%20be%20small%20and%20allow%20developers%20to%20write%20their%20own%20extensions.%20One%20way%20to%20introduce%20new%20resource%20types%20is%20using%20CustomResourceDefintions%20%28CRD%29%20%28originally%20known%20as%20ThirdPartyResources%29.%20Using%20CRDs%20anyone%20can%20define%20a%20new%20resource%20type%20that%20behaves%20like%20standard%20Kubernetes%20resources.%20This%20allows%20anyone%20to%20write%20a%20controller%20for%20custom%20resources%20and%20capture%20operational%20knowledge%20in%20a%20software%20form.&source=LinkedIn" class=linkedin><i class="fa fa-linkedin" aria-hidden=true></i></a></li><li><a title=Facebook href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.byte.builders%2fpost%2fappbinding%2f" class=facebook aria-label="share on Facebook"><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href="mailto:?subject=The%20case%20for%20AppBinding&body=https%3a%2f%2fblog.byte.builders%2fpost%2fappbinding%2f"><i class="fa fa-envelope-o" aria-hidden=true></i></a></li></ul></div></div></div><div class="column is-8"><div class=blog-content><p>Kubernetes has become the de-facto orchestrator for the cloud native world. Kubernetes upholds the philosophy that the core should be small and allow developers to write their own extensions. One way to introduce new resource types is using <code>CustomResourceDefintions (CRD)</code> (originally known as <code>ThirdPartyResources</code>). Using CRDs anyone can define a new resource type that behaves like standard Kubernetes resources. This allows anyone to write a controller for custom resources and capture operational knowledge in a software form. CoreOS popularized the term &ldquo;<a href=https://coreos.com/blog/introducing-operators.html>operators</a>&rdquo; as a name for this pattern.</p><p>At <a href=https://twitter.com/AppsCodeHQ>AppsCode</a> , we have used this model to build various Kubernetes native applications. For example, we have been working on a project called <a href=https://twitter.com/KubeDB>KubeDB</a> that automates the management of databases on Kubernetes. This is kind of like AWS RDS but using containers running on Kubernetes. For example, to deploy a PostgreSQL database you can use a yaml definition like below:</p><div class=highlight id=codeblock-0><div class=code-block-heading><div class=code-title><h4>Sample PostgreSQL</h4></div><div class=copy-and-download><button class=download-here><i class="fa fa-download" aria-hidden=true title=Download></i></button>
<button class=copy-here data-clipboard-target="#codeblock-0 pre code" title=Copy>
<i class="fa fa-clipboard" aria-hidden=true></i></button></div></div><pre><code class=language-yaml>apiVersion: kubedb.com/v1alpha1
kind: Postgres
metadata:
  name: quick-postgres
  namespace: demo
spec:
  version: &quot;10.2-v1&quot;
  storageType: Durable
  storage:
    storageClassName: &quot;standard&quot;
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: 1Gi
  terminationPolicy: DoNotTerminate
</code></pre><p></div></p><h2 id=connecting-operators>Connecting Operators</h2><p>As time goes on, more and more functionality of running the day to day operations on Kubernetes is captured via CRDs and their associated operators. For example, our users have been <a href=https://github.com/kubedb/project/issues/141>asking</a> us to support user management for KubeDB managed databases using <a href=https://www.vaultproject.io/>HashiCorp Vault</a>. Vault is a secret management server for various types of secrets including Database secrets. We have been working on a project called <a href=https://twitter.com/KubeVault>KubeVault</a> to bring a Kubernetes native experience for secret management via Vault. Now, one of the challenges we face is how to connect CRDs from KubeDB project with CRDs from KubeVault project. Here are the requirements:</p><ul><li>Users should not be forced to use both projects. They may choose to use one of the projects for their intended purpose. But they should be able to leverage them both for additional functionality.</li><li>Users should be able to bring in databases managed outside a Kubernetes cluster and use the KubeVault operator to issue secrets for such databases. For example, a user may be using an AWS RDS managed database. They want to use the KubeVault project to manage secrets for such databases. Or, users may want to provision databases using Helm charts but use KubeVault for user management.</li></ul><p>These requirements mean that we canâ€™t tightly couple CRDs from different projects. Rather we need an intermediate resource that can connect services managed by different tools.</p><h2 id=connection-configuration>Connection Configuration</h2><p>The key piece of information needed to connect different services are usually an URL for the application, some secret credential and/or some configuration parameters. So, we considered using a standard Kubernetes <code>Service</code> object. But that will mean that we have to use annotations to point to additional secrets and configmaps for such a Service. We would like to avoid using annotations for specification. Also, if such a service is hosted outside a Kubernetes cluster, a Kubernetes <code>Service</code> object seems like the wrong place to store connection information.</p><h2 id=service-catalog>Service Catalog</h2><p>We looked around to see if this problem has been addressed by others in the community. The closed project we found is <a href=https://github.com/kubernetes-incubator/service-catalog>Service Catalog</a>. Service Catalog lets anyone provision cloud services directly from the comfort of native Kubernetes tooling. This project brings integration with service brokers to the Kubernetes ecosystem via the <a href=https://github.com/openservicebrokerapi/servicebroker>Open Service Broker API</a>. Service catalog project has a resource type called <a href=https://github.com/kubernetes-incubator/service-catalog/blob/master/docs/v1/api.md#servicebinding-resource><code>ServiceBinding</code></a> that can be used to represent connection information for a resource managed via service broker. But it has 2 major issues:</p><ul><li>Service catalog expects resources to be managed by a service broker. But in our case, the resource may be already present and not managed by any broker. Going back to our prior example, a user may already have an AWS RDS managed PostgreSQL database. They just want to manage its secrets using KubeVault.</li><li>Service catalog project is implemented as a Kubernetes extended apiserver. This means users of a service catalog has to deploy and manage an additional etcd cluster. This introduced significant operational complexity for users. The friction of depending on an extended apiserver is unacceptable for an operator like KubeVault.</li></ul><h2 id=appbinding>AppBinding</h2><p>Hence, we came up with the concept of <code>AppBinding</code>. AppBinding points to an application using either its URL (usually for a non-Kubernetes resident service instance) or a Kubernetes service object (if hosted inside a Kubernetes cluster), some optional parameters and a credential secret. AppBinding is pretty similar to ServiceBinding concept in Service catalog with the following key differences:</p><ul><li>AppBinding is a CRD. So, any project that wants to depend on the AppBinding concept can register the CRD type and start using it. There is zero operational overload of using an AppBindign resource.</li><li>An AppBinding can refer to an application via its URL or service reference (if hosted inside a Kubernetes cluster). There is no need to come up with service classes, service plans, etc. like in the case of a service catalog.</li></ul><p>Here is an example of an AppBinding that points to a PostgreSQL instance.</p><div class=highlight id=codeblock-1><div class=code-block-heading><div class=code-title><h4>Sample AppBinding</h4></div><div class=copy-and-download><button class=download-here><i class="fa fa-download" aria-hidden=true title=Download></i></button>
<button class=copy-here data-clipboard-target="#codeblock-1 pre code" title=Copy>
<i class="fa fa-clipboard" aria-hidden=true></i></button></div></div><pre><code class=language-yaml>apiVersion: appcatalog.appscode.com/v1alpha1
kind: AppBinding
metadata:
  name: postgres-app
  namespace: demo
spec:
  secret:
    name: postgres-user-cred # secret
  clientConfig:
    service:
      name: postgres
      scheme: postgresql
      port: 5432
      path: &quot;postgres&quot;
      query: &quot;sslmode=disable&quot;
    insecureSkipTLSVerify: true
  parameters:
    # names of the allowed roles to use this connection config in Vault
    allowedRoles: &quot;*&quot;
</code></pre><p></div></p><p>Now, KubeVault operator can refer to this database object from itâ€™s own CRD and issue secrets accordingly.</p><p>You can find the type definition and auto-generated Go client for AppBinding on <a href=https://github.com/kmodules/custom-resources/blob/master/apis/appcatalog/v1alpha1/appbinding_types.go>GitHub</a>.</p><p>If you have read all the way to the end, I want to thank you. If you have any questions and want to know more, you can reach me via <a href=https://twitter.com/tsaha>Twitter</a> or <a href=mailto:tamal@appscode.com>Email</a>.</p><div class=tags><a href=/tags/kubernetes class=tag>kubernetes</a>
<a href=/tags/crd class=tag>crd</a>
<a href=/tags/service-catalog class=tag>service-catalog</a></div></div></div></div></div></section><section class="cta-area section-padding"><div class="container section"><div class=columns><div class="column is-5 has-text-left"><div class="section-title is-dark-bg"><h2>Get Up and Running Quickly</h2><p>Deploy, manage, upgrade Kubernetes on any cloud and automate deployment, scaling, and management of containerized applications.</p></div><div class="cta-buttons buttons"><a href=https://byte.builders/user/sign_up class="button is-primary is-large">Get started free</a>
<a href=https://appscode.com/meet-expert/ class="button is-large is-white-hoverable">Get a Demo</a></div></div><div class="column is-4 is-offset-3"><div class="right-sidebar style-1"><div class=right-sidebar-inner><div class=single-sidebar-item><h5>Want to host dedicated setup? We got you.</h5><a href=https://appscode.com/contact/ class=inline-button>Contact us</a></div><div class=single-sidebar-item><h5>Need Support SLA for AppsCode OSS projects?</h5><a href=https://appscode.com/pricing/ class=inline-button>Purchase our commercial support package</a></div><div class=single-sidebar-item><h5>Interested in Professional Services & Training?</h5><a href=https://appscode.com/consulting/ class=inline-button>Explore our services</a></div></div></div></div></div></div></section><footer class=footer-area><div class=footer-top><div class="container section"><div class=columns><div class="column is-4"><div class=single-footer-widget><div class=footer-logo><a href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode class=img></a></div><div class=subscription-form><form action="https://appscode.us17.list-manage.com/subscribe/post?u=feb2bf31969a951e7449048a3&amp;id=82fb19acb9" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=navbar-form target=_blank rel=noopener novalidate role=email><h4>Subscribe to Our Newsletter</h4><p class=spam-message>No spam, we promise. Your mail address is secure</p><div class="field has-addons"><div class=control><input class=input name=EMAIL id=mce-EMAIL type=email placeholder="Your work email address" required>
<button id=mc-embedded-subscribe type=submit name=subscribe class=subscription-button>
<i class="fa fa-paper-plane-o" aria-hidden=true></i></button></div></div></form></div><div class=contact-information><h4>Have any Inquiry?</h4><ul class=all-contact-info><li><a href=callto:&#43;1%28650%29241-8486><span><i class="fa fa-phone" aria-hidden=true></i></span>&#43;1(650)241-8486</a></li><li><a href=mailto:support@appscode.com><span><i class="fa fa-envelope-o" aria-hidden=true></i></span>support@appscode.com</a></li></ul></div></div></div><div class="column is-2"><div class=single-footer-widget><div class=footer-menu><h4>Products</h4><ul class=footer-link><li><a href=https://kubedb.com>KubeDB</a></li><li><a href=https://appscode.com/products/stash/>Stash</a></li><li><a href=https://kubevault.com>KubeVault</a></li><li><a href=https://appscode.com/products/voyager/>Voyager</a></li><li><a href=https://appscode.com/products/guard/>Guard</a></li><li><a href=https://pharmer.io>Pharmer</a></li></ul></div></div></div><div class="column is-2"><div class=single-footer-widget><div class=footer-menu><h4>Services</h4><ul class=footer-link><li><a href=https://appscode.com/consulting/>Consulting</a></li><li><a href=https://appscode.com/training/>Training</a></li><li><a href=https://appscode.com/support/>Support</a></li></ul></div></div></div><div class="column is-2"><div class=single-footer-widget><div class=footer-menu><h4>Company</h4><ul class=footer-link><li><a href=https://appscode.com/about/>About Us</a></li><li><a href=https://blog.byte.builders>Blog</a></li><li><a href=https://appscode.com/contact/>Contact Us</a></li></ul></div></div></div><div class="column is-2"><div class=single-footer-widget><div class=footer-menu><h4>Legal</h4><ul class=footer-link><li><a href=https://appscode.com/legal/tos/>Terms of Sevice</a></li><li><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a></li><li><a href=https://appscode.com/legal/security/>Security</a></li><li><a href=https://appscode.com/legal/sla/>Service Level Agreement</a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container section"><div class=columns><div class="column is-4"><p>Â© 2019 AppsCode Inc. All rights reserved.</p></div><div class="column is-4 has-text-centered-desktop has-text-left-touch"><div class=footer-inline-link><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a>
<a href=https://appscode.com/legal/tos/>Terms of Service</a></div></div><div class="column is-4 has-text-right-desktop has-text-left-touch"><div class=social-link-inline><ul><li><a href=https://twitter.com/AppsCodeHQ><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a href=https://www.facebook.com/appscode><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href=https://www.youtube.com/c/AppsCodeInc><i class="fa fa-youtube" aria-hidden=true></i></a></li></ul></div></div></div></div></div></footer><button class=go-to-top id=goTop>
<i class="fa fa-angle-up" aria-hidden=true></i></button>
<script src=https://unpkg.com/downloadjs@1.4.7/download.min.js></script><script src=https://unpkg.com/clipboard@2/dist/clipboard.min.js></script><script src=/assets/js/main.js></script></body></html>