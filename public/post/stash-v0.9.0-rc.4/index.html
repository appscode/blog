<!doctype html><html lang=en><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-62096468-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#0071BD><title>Blog | ByteBuilders</title><link rel=apple-touch-icon sizes=57x57 href=/assets/images/products/bytebuilders/icons/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/assets/images/products/bytebuilders/icons/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/assets/images/products/bytebuilders/icons/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/assets/images/products/bytebuilders/icons/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/assets/images/products/bytebuilders/icons/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/assets/images/products/bytebuilders/icons/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/assets/images/products/bytebuilders/icons/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/assets/images/products/bytebuilders/icons/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/assets/images/products/bytebuilders/icons/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/assets/images/products/bytebuilders/icons/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/assets/images/products/bytebuilders/icons/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/assets/images/products/bytebuilders/icons/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/assets/images/products/bytebuilders/icons/favicon-16x16.png><link rel=manifest href=/assets/images/products/bytebuilders/icons/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/assets/images/products/bytebuilders/icons/ms-icon-144x144.png><link rel=stylesheet href=/assets/css/font-awesome.min.css><link href=https://unpkg.com/aos@2.3.1/dist/aos.css rel=stylesheet><link rel=stylesheet href=/assets/css/bulma.min.css><link rel=stylesheet href=/assets/sass/main.min.css></head><body><header id=header><div class=header-top><div class=container><nav class="navbar customize-navbar" role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://byte.builders><img src=/assets/images/products/bytebuilders/bytebuilders.png></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-end><a href=https://marketplace.byte.builders class=navbar-item>Marketplace</a>
<a href=https://blog.byte.builders class=navbar-item>Blog</a>
<a href=https://appscode.com/about/ class=navbar-item>About Us</a>
<a href=https://appscode.com/contact/ class=navbar-item>Contact</a><div class=navbar-item><div class=buttons><a href=https://byte.builders/user/sign_up class="button is-light is-primary">Sign up</a>
<a href=https://byte.builders/user/login class="button is-primary">Sign in</a></div></div></div></div></nav></div></div></header><section class="blog-heading-area section-padding"><div class="container section"><div class=columns><div class="column has-text-centered"><div class=blog-heading><p data-aos=fade-up class=meta-date><i class="fa fa-calendar" aria-hidden=true></i>24-Jan-2020</p><h1 data-aos=fade-up data-aos-duration=500>Stash v0.9.0-rc.4 - Introducing Batch Backup and Hooks</h1><p data-aos=fade-up data-aos-duration=600 class=author><span>by </span><a href=/authors/emruz-hossain>Emruz Hossain</a></p></div><figure class=fig-style><img data-aos=fade-up data-aos-duration=600 src=/post/stash-v0.9.0-rc.4/hero_hu45d20cf51dfbf96411b1b035b74290c7_226276_1300x650_fill_q75_box_smart1.jpg alt></a></figure></div></div></div></section><section class=blog-details-area><div class="container section"><div class=columns><div class="column is-2"><div class=sticky-social-menu><div class=social-link-vertical><ul><li><a title=Twitter href="http://twitter.com/share?url=https%3a%2f%2fblog.byte.builders%2fpost%2fstash-v0.9.0-rc.4%2f&text=Stash%20v0.9.0-rc.4%20-%20Introducing%20Batch%20Backup%20and%20Hooks" class=twitter aria-label="share on Twitter"><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a title=Linkedin href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.byte.builders%2fpost%2fstash-v0.9.0-rc.4%2f&title=Stash%20v0.9.0-rc.4%20-%20Introducing%20Batch%20Backup%20and%20Hooks&summary=We%20are%20very%20excited%20to%20announce%20Stash%20v0.9.0-rc.4%20which%20brings%20some%20cool%20features%20like%20batch%20backup%20and%20hooks.%20We%20have%20also%20added%20Percona-XtraDB%20addon.%20This%20version%20also%20comes%20with%20some%20bug%20fixes%20and%20general%20improvements.%0aStash%20by%20AppsCode%20is%20a%20data%20backup%20and%20recovery%20solution%20for%20Kubernetes%20workloads.%20If%20you%20are%20running%20production%20workloads%20in%20Kubernetes%2c%20you%20might%20want%20to%20take%20backup%20of%20your%20disks%2c%20databases%20etc.%20Traditional%20tools%20are%20too%20complex%20to%20setup%20and%20maintain%20in%20a%20dynamic%20compute%20environment%20like%20Kubernetes.&source=LinkedIn" class=linkedin><i class="fa fa-linkedin" aria-hidden=true></i></a></li><li><a title=Facebook href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.byte.builders%2fpost%2fstash-v0.9.0-rc.4%2f" class=facebook aria-label="share on Facebook"><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href="mailto:?subject=Stash%20v0.9.0-rc.4%20-%20Introducing%20Batch%20Backup%20and%20Hooks&body=https%3a%2f%2fblog.byte.builders%2fpost%2fstash-v0.9.0-rc.4%2f"><i class="fa fa-envelope-o" aria-hidden=true></i></a></li></ul></div></div></div><div class="column is-8"><div class=blog-content><p>We are very excited to announce Stash <code>v0.9.0-rc.4</code> which brings some cool features like batch backup and hooks. We have also added <code>Percona-XtraDB</code> addon. This version also comes with some bug fixes and general improvements.</p><p>Stash by AppsCode is a data backup and recovery solution for Kubernetes workloads. If you are running production workloads in Kubernetes, you might want to take backup of your disks, databases etc. Traditional tools are too complex to setup and maintain in a dynamic compute environment like Kubernetes. Stash is a Kubernetes operator built around <code>[restic](https://github.com/restic/restic)</code> to address these issues. Using Stash, you can backup Kubernetes volumes mounted in workloads, stand-alone volumes and databases.</p><h2 id=features>Features</h2><table><thead><tr><th>Features</th><th align=center>Availability</th><th>Scope</th></tr></thead><tbody><tr><td>Backup &amp; Restore Workload Data</td><td align=center>&#10003;</td><td>Deployment, DaemonSet, StatefulSet, ReplicaSet, ReplicationController, OpenShift DeploymentConfig</td></tr><tr><td>Backup &amp; Restore Stand-alone Volume (PVC)</td><td align=center>&#10003;</td><td>PersistentVolumeClaim, PersistentVolume</td></tr><tr><td>Backup &amp; Restore databases</td><td align=center>&#10003;</td><td>PostgreSQL, MySQL, MongoDB, Elasticsearch</td></tr><tr><td><a href=https://kubernetes.io/docs/concepts/storage/volume-snapshots/>VolumeSnapshot</a></td><td align=center>&#10003;</td><td>CSI Driver must support VolumeSnapshot and Kubernetes Alpha features must be enabled</td></tr><tr><td>Schedule Backup</td><td align=center>&#10003;</td><td>Schedule through <a href=https://en.wikipedia.org/wiki/Cron>cron expression</a></td></tr><tr><td>Instant Backup</td><td align=center>&#10003;</td><td>Use CLI or create BackupSession manually</td></tr><tr><td>Auto Backup</td><td align=center>&#10003;</td><td>Using a Template and annotations</td></tr><tr><td>Batch Backup</td><td align=center>&#10003;</td><td>Backup multiple co-related targets under a single configuration</td></tr><tr><td>Pause Scheduled Backup</td><td align=center>&#10003;</td><td></td></tr><tr><td>Support Multiple Storage Provider</td><td align=center>&#10003;</td><td>AWS S3, Minio, Rook, GCS, Azure, OpenStack Swift, Backblaze B2, Rest Server, any PV/PVC</td></tr><tr><td>Encryption</td><td align=center>&#10003;</td><td>AES-256 in counter mode (CTR) (for Restic driver)</td></tr><tr><td>Deduplication (send only diff)</td><td align=center>&#10003;</td><td>Uses <a href=https://restic.net/blog/2015-09-12/restic-foundation1-cdc>Content Defined Chunking (CDC)</a> (for Restic driver)</td></tr><tr><td>Cleanup old snapshots automatically</td><td align=center>&#10003;</td><td>Cleanup according to different <a href=https://restic.readthedocs.io/en/stable/060_forget.html#removing-snapshots-according-to-a-policy>retention policies</a></td></tr><tr><td>Prometheus Metrics for Backup &amp; Restore Process</td><td align=center>&#10003;</td><td>Official Prometheus Server, CoreOS Prometheus Operator</td></tr><tr><td>Prometheus Metrics for Stash Operator</td><td align=center>&#10003;</td><td>Official Prometheus Server, CoreOS Prometheus Operator</td></tr><tr><td>Support RBAC enabled cluster</td><td align=center>&#10003;</td><td></td></tr><tr><td>Support PSP enabled cluster</td><td align=center>&#10003;</td><td></td></tr><tr><td>CLI</td><td align=center>&#10003;</td><td><code>kubectl</code> plugin (for Kubernetes 1.12+)</td></tr><tr><td>Extensibility</td><td align=center>&#10003;</td><td>Extend using <code>Function</code> and <code>Task</code></td></tr><tr><td>Customizability</td><td align=center>&#10003;</td><td>Customize backup / restore process using <code>Function</code> and <code>Task</code></td></tr><tr><td>Hooks</td><td align=center>&#10003;</td><td>Execute <code>httpGet</code>, <code>httpPost</code>, <code>tcpSocket</code> and <code>exec</code> hooks before and after of backup or restore process.</td></tr><tr><td>Send Notification to Webhook</td><td align=center>&#10003;</td><td>Use hooks to send notification to webhooks(i.e. Slack channel)</td></tr></tbody></table><h2 id=what-s-new>What&rsquo;s New</h2><p>The following new features has been introduced in this version.</p><h3 id=batch-backup>Batch Backup</h3><p>Sometimes, a single component may not meet the requirement for your application. For example, in order to deploy a WordPress, you will need a Deployment for the WordPress and another Deployment for database to store it’s contents. Now, you may want to backup both of the deployment and database under a single configuration as they are parts of a single application.</p><p>In order to support this use case, we are introducing <a href=https://stash.run/docs/v0.9.0-rc.4/concepts/crds/backupbatch/>BackupBatch</a> CRD. This allows users to specify multiple targets under single configuration. For more details, please check these guides:</p><ul><li><a href=https://stash.run/docs/v0.9.0-rc.4/concepts/crds/backupbatch/>BackupBatch CRD Specification</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/batch-backup/overview/>How Batch Backup Works</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/batch-backup/batch-backup/>An Example of Batch Backup</a></li></ul><h3 id=hooks>Hooks</h3><p>You may need to prepare your application before backup/restore. For, example you may want to pause your application before backup and resume it after backup to ensure the backed up data consistency. You may want to send a notification after a backup is completed. Or, you may want to remove corrupted data before restoring. In order to support those use cases, we are introducing <code>Hooks</code> in this version.</p><p>Stash hooks allows executing certain action before and after a backup/restore process. You can send HTTP requests to a remote server via <code>httpGet</code> or <code>httpPost</code> hooks. You can check whether a TCP socket is open using <code>tcpSocket</code> hook. You can also execute some commands into your application pod using <code>exec</code> hook. For more details, please follow these guides:</p><ul><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/hooks/overview/>Types of Hooks and How They Works</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/hooks/backup-and-restore-hooks/>Example of Backup and Restore Hooks</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/hooks/batch-backup-hooks/>Example of Hooks in Batch Backup</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/hooks/configuring-hooks/>How to Configure Different Types of Hooks</a></li></ul><h3 id=percona-xtradb-addon>Percona-XtraDB Addon</h3><p>We have added a new addon for taking backup <code>Percona-XtraDB</code> cluster. Currently, it only supports Percona XtraDB version <code>5.7</code>. Please check these guides for more details:</p><ul><li><a href=https://stash.run/docs/v0.9.0-rc.4/guides/latest/addons/overview/>What is a Stash Addon</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/addons/percona-xtradb/overview/>How Percona XtraDB Backup Works</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/addons/percona-xtradb/setup/install/>How to Install Percona-XtraDB Addon</a></li><li><a href=https://stash.run/docs/v0.9.0-rc.4/addons/percona-xtradb/guides/5.7/clustered/>Example of How to Backup a Percona-XtraDB Cluster</a></li></ul><h2 id=important-bug-fixes>Important Bug Fixes</h2><p>We have fixes the following noticeable bugs:</p><ul><li>Failed to create CronJob when BackupConfiguration name is same as Database crd name <a href=https://github.com/stashed/stash/issues/1022>#1022</a></li><li>Can&rsquo;t install stash <a href=https://github.com/stashed/stash/issues/1032>#1032</a></li><li>Backup mysql creates infinite dumps <a href=https://github.com/stashed/stash/issues/1030>#1030</a></li><li>BackupSession skipped for paused BackupConfiguration <a href=https://github.com/stashed/stash/issues/997>#997</a></li><li>Operator is observing panic() while handling failed CronJob creation for BackupConfiguration <a href=https://github.com/stashed/stash/issues/1019>#1019</a></li><li>Stash Addons: Make chart.sh script compatible with helm 3<a href=https://github.com/stashed/stash/issues/984>#984</a></li><li>backup error for items <a href=https://github.com/stashed/stash/issues/1018>#1018</a></li><li>RBAC permission missing in Chart for PersistentVolumeClaim, exists in installer deploy script <a href=https://github.com/stashed/stash/issues/981>#981</a></li><li>Clarify that user can not user <code>/stash</code> as <code>mountPath</code> for local backend <a href=https://github.com/stashed/stash/issues/945>#945</a></li><li>Invalid flag name for PVC restorer job <a href=https://github.com/stashed/stash/issues/956>#956</a></li></ul><p>Please try this version and let us know if you face any issues. You can follow us on Twitter <a href=https://twitter.com/KubeStash>@KubeStash</a>, talk to us on <a href=https://appscode.slack.com>Slack</a> or file an issue <a href=https://github.com/stashed/stash/issues>here</a>.</p><div class=tags><a href=/tags/kubernetes class=tag>kubernetes</a>
<a href=/tags/stash class=tag>stash</a>
<a href=/tags/backup class=tag>backup</a></div></div></div></div></div></section><section class="cta-area section-padding"><div class="container section"><div class=columns><div class="column is-5 has-text-left"><div class="section-title is-dark-bg" data-aos=fade-up><h2>Get Up and Running Quickly</h2><p>Deploy, manage, upgrade Kubernetes on any cloud and automate deployment, scaling, and management of containerized applications.</p></div><div class="cta-buttons buttons" data-aos=fade-up data-aos-duration=600><a href=https://byte.builders/user/sign_up class="button is-primary is-large">Get started free</a>
<a href=https://appscode.com/meet-expert/ class="button is-large is-white-hoverable">Get a Demo</a></div></div><div class="column is-4 is-offset-3"><div class="right-sidebar style-1"><div class=right-sidebar-inner><div class=single-sidebar-item data-aos=fade-left><h5>Want to host dedicated setup? We got you.</h5><a href=https://appscode.com/contact/ class=inline-button>Contact us</a></div><div class=single-sidebar-item data-aos=fade-left data-aos-duration=500><h5>Need Support SLA for AppsCode OSS projects?</h5><a href=https://appscode.com/pricing/ class=inline-button>Purchase our commercial support package</a></div><div class=single-sidebar-item data-aos=fade-left data-aos-duration=700><h5>Interested in Professional Services & Training?</h5><a href=https://appscode.com/consulting/ class=inline-button>Explore our services</a></div></div></div></div></div></div></section><footer class=footer-area><div class=footer-top><div class="container section"><div class="columns is-mobile is-multiline" data-aos=fade-up><div class="column is-full-mobile is-one-third-desktop is-one-third-widescreen is-one-third-tablet"><div class=single-footer-widget><div class=footer-logo><a href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode class=img></a></div><div class=subscription-form><form action="https://appscode.us17.list-manage.com/subscribe/post?u=feb2bf31969a951e7449048a3&amp;id=82fb19acb9" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=navbar-form target=_blank rel=noopener novalidate role=email><h4>Subscribe to Our Newsletter</h4><p class=spam-message>No spam, we promise. Your mail address is secure</p><div class="field has-addons"><div class=control><input class=input name=EMAIL id=mce-EMAIL type=email placeholder="Your work email address" required>
<button id=mc-embedded-subscribe type=submit name=subscribe class=subscription-button>
<i class="fa fa-paper-plane-o" aria-hidden=true></i></button></div></div></form></div><div class=contact-information><h4>Have any Inquiry?</h4><ul class=all-contact-info><li><a href=callto:&#43;1%28650%29241-8486><span><i class="fa fa-phone" aria-hidden=true></i></span>&#43;1(650)241-8486</a></li><li><a href=mailto:support@appscode.com><span><i class="fa fa-envelope-o" aria-hidden=true></i></span>support@appscode.com</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=400><div class=single-footer-widget><div class=footer-menu><h4>Products</h4><ul class=footer-link><li><a href=https://kubedb.com>KubeDB</a></li><li><a href=https://appscode.com/products/stash/>Stash</a></li><li><a href=https://kubevault.com>KubeVault</a></li><li><a href=https://appscode.com/products/voyager/>Voyager</a></li><li><a href=https://appscode.com/products/guard/>Guard</a></li><li><a href=https://pharmer.io>Pharmer</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=500><div class=single-footer-widget><div class=footer-menu><h4>Services</h4><ul class=footer-link><li><a href=https://appscode.com/consulting/>Consulting</a></li><li><a href=https://appscode.com/training/>Training</a></li><li><a href=https://appscode.com/support/>Support</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=600><div class=single-footer-widget><div class=footer-menu><h4>Company</h4><ul class=footer-link><li><a href=https://appscode.com/about/>About Us</a></li><li><a href=https://blog.byte.builders>Blog</a></li><li><a href=https://appscode.com/contact/>Contact Us</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=700><div class=single-footer-widget><div class=footer-menu><h4>Legal</h4><ul class=footer-link><li><a href=https://appscode.com/legal/tos/>Terms of Sevice</a></li><li><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a></li><li><a href=https://appscode.com/legal/security/>Security</a></li><li><a href=https://appscode.com/legal/sla/>Service Level Agreement</a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container section"><div class=columns><div class="column is-4"><p>© 2020 AppsCode Inc. All rights reserved.</p></div><div class="column is-4 has-text-centered-desktop has-text-left-touch"><div class=footer-inline-link><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a>
<a href=https://appscode.com/legal/tos/>Terms of Service</a></div></div><div class="column is-4 has-text-right-desktop has-text-left-touch"><div class=social-link-inline><ul><li><a href=https://twitter.com/AppsCodeHQ><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a href=https://www.facebook.com/appscode><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href=https://www.youtube.com/c/AppsCodeInc><i class="fa fa-youtube" aria-hidden=true></i></a></li></ul></div></div></div></div></div></footer><button class=go-to-top id=goTop>
<i class="fa fa-angle-up" aria-hidden=true></i></button>
<script src=https://unpkg.com/aos@2.3.1/dist/aos.js></script><script src=https://unpkg.com/downloadjs@1.4.7/download.min.js></script><script src=https://unpkg.com/clipboard@2/dist/clipboard.min.js></script><script src=/assets/js/main.js></script><script type=text/javascript>var Tawk_API=Tawk_API||{},Tawk_LoadStart=new Date();(function(){var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];s1.async=true;s1.src='https://embed.tawk.to/5821e34b18d9f16af02864b7/default';s1.charset='UTF-8';s1.setAttribute('crossorigin','*');s0.parentNode.insertBefore(s1,s0);})();</script></body></html>